---
title: "Strava data pipeline"
format: html
---

Importing libraries
```{python}
import requests
import pandas as pd
import mysql.connector
```

Request data from Strava API
```{python}
url = 'https://www.strava.com/api/v3/athlete'

headers = {'Authorization':'Bearer 89cb0407f703351aee347440d5be6fc360afa568'}

r = requests.get(url, headers=headers)
data =  r.json()
data = pd.DataFrame([data])
data = data[['id','username', 'firstname', 'lastname', 'city', 'sex', 'weight']]
```

Connect to MySQL DB
```{python}
# Connect to MySQL DB
strava_db = mysql.connector.connect(
    host = 'JoniPC',
    user = 'strava_db_user',
    password = 'Strava_connect@2025',
    database = 'strava_db',
    port = 3306
)    
```


```{python}
cur=strava_db.cursor()

cur.execute("SHOW DATABASES")
```


```{python}
row = cur.fetchone()

print("Current date is: {0}".format(row))
```


```{python}
cur._connection
```